!function(a,b){function c(){return a.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):a.XMLHttpRequest?new XMLHttpRequest:void 0}function d(a,b,d){this.uri_="//"+b+"."+a+"/logstores/"+d+"/track?APIVersion=0.6.0",this.params_=new Array,this.httpRequest_=c()}d.prototype={push:function(a,b){a&&b&&(this.params_.push(a),this.params_.push(b))},logger:function(){for(var b=this.uri_,c=0;this.params_.length>0;)b+=c%2==0?"&"+encodeURIComponent(this.params_.shift()):"="+encodeURIComponent(this.params_.shift()),++c;try{this.httpRequest_.open("GET",b,!0),this.httpRequest_.send(null)}catch(c){a&&a.console&&"function"==typeof a.console.log&&(console.log("Failed to log to ali log service because of this exception:\n"+c),console.log("Failed log data:",b))}}},a.Tracker=d}(window,document);var BJ_REPORT=function(a){if(a.BJ_REPORT)return a.BJ_REPORT;var b,c=[],d={},e={id:0,uin:0,url:"",combo:1,ext:null,level:4,ignore:[],random:1,delay:1e3,submit:null,repeat:5},f=function(a,b){return Object.prototype.toString.call(a)==="[object "+(b||"Object")+"]"},g=function(a){var b=typeof a;return"object"===b&&!!a},h=a.onerror;a.onerror=function(b,c,d,e,g){var i=b;g&&g.stack&&(i=j(g)),f(i,"Event")&&(i+=i.type?"--"+i.type+"--"+(i.target?i.target.tagName+"::"+i.target.src:""):""),n.push({msg:i,target:c,rowNum:d,colNum:e}),m(),h&&h.apply(a,arguments)};var i=function(a){try{if(a.stack){var b=a.stack.match("https?://[^\n]+");b=b?b[0]:"";var c=b.match(":(\\d+):(\\d+)");c||(c=[0,0,0]);var d=j(a);return{msg:d,rowNum:c[1],colNum:c[2],target:b.replace(c[0],"")}}return a.name&&a.message&&a.description?{msg:JSON.stringify(a)}:a}catch(b){return a}},j=function(a){var b=a.stack.replace(/\n/gi,"").split(/\bat\b/).slice(0,9).join("@").replace(/\?[^:]+/gi,""),c=a.toString();return b.indexOf(c)<0&&(b=c+"@"+b),b},k=function(a){var c=a._meta_;delete a._meta_;for(var d in c)c.hasOwnProperty(d)&&b.push(d,c[d]);"js-error"===c.type&&b.push("message",JSON.stringify(a)),b.push("time",(new Date).getTime()),b.logger()},l=function(a){if(!g(a))return!0;var b=a.msg;if(!b)return!1;var c=d[b]=(parseInt(d[b],10)||0)+1;return c>e.repeat},m=function(a){if(e.report)for(;c.length;){var b=!1,d=c.shift();if(!l(d)&&d._meta_.type){if(f(e.ignore,"Array"))for(var g=0,h=e.ignore.length;g<h;g++){var i=e.ignore[g],j=JSON.stringify(d);if(f(i,"RegExp")&&i.test(j)||f(i,"Function")&&i(d,j)){b=!0;break}}b||(k(d),e.onReport&&e.onReport(e.id,d))}}},n=a.BJ_REPORT={push:function(a,b){if(Math.random()>=e.random)return n;var d=g(a)?i(a):{msg:a};return e.ext&&!d.ext&&(d.ext=e.ext),d._meta_=b||{},c.push(d),m(),n},report:function(a){return this.error(a)},error:function(a,b){return a&&n.push(a,{type:"js-error",level:b||4,url:location.href,count:1,ua:navigator.userAgent}),m(!0),n},info:function(a){return this.error(a,1)},debug:function(a){return this.error(a,2)},init:function(a){if(g(a))for(var d in a)e[d]=a[d];b=new window.Tracker(e.endpoint,e.project,e.logstore);var f=parseInt(e.id,10);return f&&(/qq\.com$/gi.test(location.hostname)&&(e.url||(e.url="//badjs2.qq.com/badjs"),e.uin||(e.uin=parseInt((document.cookie.match(/\buin=\D+(\d+)/)||[])[1],10))),e.report=(e.url||"/badjs")+"?id="+f+"&uin="+e.uin+"&"),c.length&&m(),n},__onerror__:a.onerror};return"undefined"!=typeof console&&console.error&&setTimeout(function(){var a=((location.hash||"").match(/([#&])BJ_ERROR=([^&$]+)/)||[])[2];a&&console.error("BJ_ERROR",decodeURIComponent(a).replace(/(:\d+:\d+)\s*/g,"$1\n"))},0),n}(window);"undefined"!=typeof module&&(module.exports=BJ_REPORT);